FROM golang:1.8.1-alpine
LABEL maintaner="Stegen Smith <matthsmi@adobe.com>

### required for test
COPY ./files/doit.sh /doit.sh
COPY ./files/build_test.sh /root/build.sh
### required for test

### required to build
RUN mkdir -p /root/butler/stats /root/butler/config /root/butler/config/methods /root/butler/config/reloaders /root/butler/utils
COPY butler.go /root/butler/butler.go
COPY ./config/*.go /root/butler/config/
COPY ./config/methods/*.go /root/butler/config/methods/
COPY ./config/reloaders/*.go /root/butler/config/reloaders/
COPY ./stats/*.go /root/butler/stats/
#COPY ./utils/*.go /root/butler/utils
COPY ./vendor /root/butler/vendor

#COPY *.go /root/butler/
#COPY ./config/*.go /root/butler/config/
#COPY ./stats/*.go /root/butler/stats/
#COPY ./vendor/github.com /root/go/src/github.com
#COPY ./vendor/golang.org /root/go/src/golang.org
#COPY ./vendor/gopkg.in /root/go/src/gopkg.in
### required to build

RUN apk update && apk add bash git

CMD ["/doit.sh"]
